---
title: "Chocolate Chip Cookies"
execute:
  error: true
author: "Rayne Aurit"
output: html_document
---

## Reading In the Data

First, read in the CSV data of cookie ingredients.
Make sure that your end-result data has appropriate types for each column - these should match the types provided in the documentation in the README.md file.

```{r}
library(tidyverse)
cookies = read.csv("choc_chip_cookie_ingredients.csv")
head(cookies)
```

```{python}
import pandas as pd

cookies = pd.read_csv("choc_chip_cookie_ingredients.csv")
print(cookies.head())
```


## Exploratory Data Analysis

Exploratory data analysis is the process of getting familiar with your dataset. To get started, [this blog post](https://www.mrdbourke.com/a-gentle-introduction-to-exploratory-data-analysis/) provides a nice checklist to get you thinking:

> 1.  What question(s) are you trying to solve (or prove wrong)?
> 2.  What kind of data do you have and how do you treat different types?
> 3.  What's missing from the data and how do you deal with it?
> 4.  Where are the outliers and why should you care about them?
> 5.  How can you add, change or remove features to get more out of your data?

### Generating Questions

Generate at least 5 questions you might explore using this database of cookie ingredients.

1. Are there any missing data? What should be done about the missing data? Is excluding those instances enough?
2. What is the shape of the distribution of the rating?
3. What are the categories in unit? 
4. How many unique recipes are there?
5. Is there a correlation between the quantity of ingredients for each recipe?

*Bit went over in class*
```{r}
cookies |> str()

cookies |> filter(Recipe_Index=="AR_1")

cookies |> group_by(Ingredient) |> 
  summarize(avg_rating = mean(Rating, na.rm=T), n=n(), missing_ratings = sum(is.na(Rating))) |> 
  arrange(desc(avg_rating)) |> 
  ggplot(aes(x = n-missing_ratings, y=avg_rating, label=Ingredient)) + geom_point()

library(plotly)
ggplotly()
```

### Skimming the Data

One thing we often want to do during EDA is to examine the quality of the data - are there missing values? What quirks might exist in the data set?

The `skimr` package in R, and the similar `skimpy` package in python (which has a much better name, in my opinion), can help provide visual summaries of the data. 

Install both packages, and read the package documentation ([R](https://cran.r-project.org/web/packages/skimr/vignettes/skimr.html), [Python](https://pypi.org/project/skimpy/)).

[Part 1] Use each package and generate summaries of your data that require the use of at least some non-default options in each package's `skim` function.


```{r}
#install.packages("skimr")
library(skimr)
library(dplyr)

skim(cookies) |>
  tibble::as_tibble()

skim(cookies) |> 
  dplyr::filter(skim_variable == "Rating")
```

```{python}
from skimpy import skim

skim(cookies)
skim(cookies[["Rating"]])
```

[Part 2] Write 1-2 sentences about what you can tell from each summary display you generate. Did you discover anything new about the data?

*I discovered upon looking closer at the table that Rating has a lot of missing values. The same are done in both R and python. I enjoyed how it has different outputs for different classes of variables. When the variable was a string, it displayed the minimum and maximum characters in the string. If numeric, it provided the summary statistics.*

### Generating Tables

Another useful technique for exploratory data analysis is to generate summary tables. 
You may want to use the `dplyr` package in R (`group_by` or `count` functions), as well as the `groupby` and `count` methods in Pandas. [Python example](https://sparkbyexamples.com/pandas/pandas-groupby-count-examples/), [R example](https://dplyr.tidyverse.org/reference/count.html)

[Part 1] Using R and Python, generate a table that shows what **proportion** of recipes contain each type of ingredient, for the most common 20 ingredients.

```{r}
n_recipes <- n_distinct(cookies$Recipe_Index)

top = cookies |>
  group_by(Ingredient) |>
  summarize(prop = n_distinct(Recipe_Index) / n_recipes) |>
  arrange(desc(prop))
top[1:20,]
```

```{python}
n_recipes = cookies["Recipe_Index"].nunique()

top = (
    cookies
        .groupby("Ingredient")["Recipe_Index"]
        .nunique()
        .div(n_recipes)
        .sort_values(ascending=False)
        .reset_index(name="prop")
)

top.head(20)
```

[Part 2] Print out a character string that lists all of the ingredients that do not appear in at least 20 recipes.

```{r}
topnah = cookies |>
  group_by(Ingredient) |>
  summarize(n_recipes = n_distinct(Recipe_Index)) |>
  arrange(desc(n_recipes)) |> 
  filter(n_recipes < 20) |> 
  pull(Ingredient)

paste(topnah, collapse = ", ")
```

### Visualization

Using whatever plotting system you are comfortable with in R or python, see if you can create a couple of useful exploratory data visualizations which address one of the questions you wrote above - or another question which you've come up with as you've worked on this assignment.

[Part 1] Create at least one plot (it doesn't have to be pretty) that showcases an interesting facet of the data.

```{r}
library(ggplot2)
cookies |> str()

cookies |>
  group_by(Recipe_Index) |>
  summarise(rating = mean(Rating, na.rm = TRUE)) |>
  ggplot(aes(x = rating)) +
  geom_histogram(bins = 15) +
  labs(x = "Recipe rating",y = "Number of recipes",title = "Distribution of unique recipe ratings")

ggplotly()
```
Other area for plot so `ggplotly()` works
```{r}
cookies |>
  group_by(Recipe_Index) |>
  summarise(n_ingredients = n(), rating = mean(Rating, na.rm = TRUE)) |>
  ggplot(aes(x = n_ingredients, y = rating, label=Recipe_Index)) +
  geom_point() +
  labs(x = "Number of ingredients",y = "Recipe rating",title = "Ingredients vs Rating")

ggplotly()
```

[Part 2] Write 2-3 sentences about what you can learn from that plot and what directions you might want to investigate from here.

*There seems to be no clear pattern between the number of ingredients and the rating of the recipe. A correlation metric would be able to give a more solid answer, but it appears more complicated recipes are not inherently better. The lowest ratings and highest ratings share the same number of ingredients. Additionally, with the first plot, we can see that there is a significant left skew. This is expected since rating is a decimal number between 0 and 1. People are more likely to rate a recipe for cookies on the higher end since they are sweet (majority of the time).*
